<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Практическое задание A-Frame</title>
    <!-- 1. Подключение физического движка -->
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
    <!-- 8. Подключение ассета из библиотеки (пример: подключаем A-Frame Extras или иной ассет) -->
    <script src="https://unpkg.com/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  </head>
  <body>
    <a-scene physics="debug: true">
      <!-- 2. Анимация исчезновения (частицы) -->
      <a-entity id="explosion" particle-system="preset: explosion; color: yellow" position="0 1 -4"></a-entity>

      <!-- 3. Интеграция звука при сборе -->
      <a-sound id="collectSound" src="yoursound.wav" autoplay="false"></a-sound>

      <!-- 4. Движущийся объект с анимацией -->
      <a-entity id="movingObj" 
                geometry="primitive: cone" 
                material="color: red"  
                position="0 2 -8"
                animation="property: position; to: 5 2 -8; dur: 2000; loop: true">
      </a-entity>

      <!-- 6. Объект с физикой -->
      <a-entity geometry="primitive: box" 
                material="color: blue"  
                position="0 5 -10" 
                dynamic-body>
      </a-entity>

      <!-- Пример использования ассета (например, 3D модель из библиотеки) -->
      <a-assets>
        <a-asset-item id="exampleModel" src="https://cdn.example.com/path/to/model.gltf"></a-asset-item>
      </a-assets>
      <a-entity gltf-model="#exampleModel" position="2 1 -5"></a-entity>
      
      <!-- Добавляем камеру для обзора сцены -->
      <a-entity camera look-controls position="0 1.6 0"></a-entity>
    </a-scene>

    <!-- 5. Рандомизация позиций при перезапуске -->
    <script>
      function spawnObjects() {
        const positions = [];
        for (let i = 0; i < 5; i++) {
          const x = Math.random() * 10 - 5;
          const z = Math.random() * 10 - 5;
          positions.push({ x: x, y: 1, z: z });
        }
        console.log("Random positions:", positions);
        return positions;
      }

      // Пример вызова функции spawnObjects при загрузке страницы или перезапуске сцены.
      document.addEventListener('DOMContentLoaded', function() {
        spawnObjects();
      });

      // 7. Компонент гравитации
      AFRAME.registerComponent('gravity', {
        tick: function () {
          if (this.el.body) { // Убедимся, что физическое тело создано
            this.el.body.applyForce(0, -9.8, 0);
          }
        }
      });

      // Пример запуска звука при событии (например, по клику)
      document.addEventListener('click', function() {
        const soundEl = document.querySelector('#collectSound');
        if (soundEl && soundEl.components && soundEl.components.sound) {
          soundEl.components.sound.playSound();
        }
      });
    </script>
  </body>
</html>
